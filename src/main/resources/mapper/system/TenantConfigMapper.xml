<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="erp.chain.mapper.system.TenantConfigMapper">
    <select id="findByNameAndTenantId" resultType="TenantConfig" >
        SELECT * FROM tenant_config t WHERE is_deleted=0
        <if test="tenantId != null and tenantId != ''">
            AND tenant_id =${tenantId}
        </if>
        <if test="key != null and key != ''">
            AND t.name =#{key}
        </if>

    </select>
    <update id="update" parameterType="TenantConfig">
        <!--
        WARNING - @mbggenerated
        This element is automatically generated by MyBatis Generator, do not modify.
        This element was generated on Fri Nov 04 15:05:01 CST 2016.
      -->
        update tenant_config
        <set >
            <if test="name != null" >
                name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="value != null" >
                value = #{value,jdbcType=VARCHAR},
            </if>
            <if test="maxValue != null" >
                max_value = #{maxValue,jdbcType=VARCHAR},
            </if>
            <if test="createBy != null" >
                create_by = #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="createAt != null" >
                create_at = #{createAt,jdbcType=TIMESTAMP},
            </if>
            <if test="lastUpdateBy != null" >
                last_update_by = #{lastUpdateBy,jdbcType=VARCHAR},
            </if>
            <if test="lastUpdateAt != null" >
                last_update_at = #{lastUpdateAt,jdbcType=TIMESTAMP},
            </if>
            <if test="isDeleted != null" >
                is_deleted = #{isDeleted,jdbcType=BIT},
            </if>
            <if test="tenantId != null" >
                tenant_id = #{tenantId,jdbcType=BIGINT},
            </if>
            <if test="version != null" >
                version = #{version,jdbcType=BIGINT},
            </if>
            <if test="localId != null" >
                local_id = #{localId,jdbcType=BIGINT},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
    <insert id="insert" parameterType="TenantConfig">
        insert into tenant_config (id, name, value,
          max_value, is_deleted,
          create_by, create_at, last_update_by,
          last_update_at, tenant_id,
          version, local_id
          )
        values (#{id,jdbcType=BIGINT}, #{name,jdbcType=VARCHAR},#{value,jdbcType=VARCHAR},
          #{maxValue,jdbcType=VARCHAR},#{isDeleted,jdbcType=BIT},
          #{createBy,jdbcType=VARCHAR}, #{createAt,jdbcType=TIMESTAMP}, #{lastUpdateBy,jdbcType=VARCHAR},
          #{lastUpdateAt,jdbcType=TIMESTAMP},#{tenantId,jdbcType=BIGINT},
          #{version,jdbcType=BIGINT}, #{localId,jdbcType=BIGINT}
          )
    </insert>

    <select id="getConfig" resultType="erp.chain.domain.system.PosSysConfig">
        SELECT * FROM pos_sys_config
        WHERE tenant_id=${tenantId}
        AND branch_id=#{branchId}
        AND employee_id=#{employeeId}
        AND type=#{type}
        AND is_deleted=0
        LIMIT 1;
    </select>
    <select id="recoverPosSysConfig" resultType="erp.chain.domain.system.PosSysConfig">
        SELECT * FROM pos_sys_config
        WHERE recover_code=#{recoverCode}
        AND type=#{type}
        AND is_deleted=0
        LIMIT 1;
    </select>
    <insert id="insertPosSysConfig" parameterType="erp.chain.domain.system.PosSysConfig" useGeneratedKeys="true" keyProperty="id">
        insert into pos_sys_config (id, tenant_id, branch_id,
        employee_id, recover_code,data,
        create_by, create_at, last_update_by,
        last_update_at, is_deleted,type
        )
        values (#{id,jdbcType=BIGINT}, #{tenantId,jdbcType=BIGINT},#{branchId,jdbcType=BIGINT},
        #{employeeId,jdbcType=BIGINT},#{recoverCode,jdbcType=VARCHAR},#{data,jdbcType=VARCHAR},
        #{createBy,jdbcType=VARCHAR}, #{createAt,jdbcType=TIMESTAMP}, #{lastUpdateBy,jdbcType=VARCHAR},
        #{lastUpdateAt,jdbcType=TIMESTAMP},#{isDeleted,jdbcType=BIT},#{type,jdbcType=VARCHAR}
        )
    </insert>
    <update id="updatePosSysConfig" parameterType="erp.chain.domain.system.PosSysConfig">
        update pos_sys_config
        <set >
            <if test="recoverCode != null" >
                recover_code = #{recoverCode,jdbcType=VARCHAR},
            </if>
            <if test="data != null" >
                data = #{data,jdbcType=VARCHAR},
            </if>
            <if test="createBy != null" >
                create_by = #{createBy,jdbcType=VARCHAR},
            </if>
            <if test="createAt != null" >
                create_at = #{createAt,jdbcType=TIMESTAMP},
            </if>
            <if test="lastUpdateBy != null" >
                last_update_by = #{lastUpdateBy,jdbcType=VARCHAR},
            </if>
            <if test="lastUpdateAt != null" >
                last_update_at = #{lastUpdateAt,jdbcType=TIMESTAMP},
            </if>
            <if test="isDeleted != null" >
                is_deleted = #{isDeleted,jdbcType=BIT},
            </if>
            <if test="tenantId != null" >
                tenant_id = #{tenantId,jdbcType=BIGINT},
            </if>
            <if test="branchId != null" >
                branch_id = #{branchId,jdbcType=BIGINT},
            </if>
            <if test="employeeId != null" >
                employee_id = #{employeeId,jdbcType=BIGINT},
            </if>
            <if test="type != null" >
                type = #{type,jdbcType=BIGINT},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
</mapper>